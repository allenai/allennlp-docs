
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="AllenNLP is a ..">
      
      
      
        <link rel="canonical" href="https://allennlp.org/api/nn/beam_search/">
      
      <link rel="icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>beam_search - AllenNLP v2.10.1</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="grey">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#statetype" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="AllenNLP v2.10.1" class="md-header__button md-logo" aria-label="AllenNLP v2.10.1" data-md-component="logo">
      
  <img src="../../../img/favicon.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AllenNLP v2.10.1
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              beam_search
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="AllenNLP v2.10.1" class="md-nav__button md-logo" aria-label="AllenNLP v2.10.1" data-md-component="logo">
      
  <img src="../../../img/favicon.ico" alt="logo">

    </a>
    AllenNLP v2.10.1
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/allenai/allennlp" class="md-nav__link">
        Repository
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Versions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Versions" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Versions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/latest/" class="md-nav__link">
        Latest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/stable/" class="md-nav__link">
        Stable
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="/main/" class="md-nav__link">
        Commit
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          commands
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="commands" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          commands
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/_checklist_internal/" class="md-nav__link">
        _checklist_internal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/build_vocab/" class="md-nav__link">
        build_vocab
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/cached_path/" class="md-nav__link">
        cached_path
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/checklist/" class="md-nav__link">
        checklist
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/count_instances/" class="md-nav__link">
        count_instances
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/diff/" class="md-nav__link">
        diff
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/evaluate/" class="md-nav__link">
        evaluate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/find_learning_rate/" class="md-nav__link">
        find_learning_rate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/predict/" class="md-nav__link">
        predict
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/print_results/" class="md-nav__link">
        print_results
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/push_to_hf/" class="md-nav__link">
        push_to_hf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/subcommand/" class="md-nav__link">
        subcommand
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/test_install/" class="md-nav__link">
        test_install
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/train/" class="md-nav__link">
        train
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          common
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="common" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          common
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/cached_transformers/" class="md-nav__link">
        cached_transformers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/checks/" class="md-nav__link">
        checks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/file_utils/" class="md-nav__link">
        file_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/from_params/" class="md-nav__link">
        from_params
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/lazy/" class="md-nav__link">
        lazy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/logging/" class="md-nav__link">
        logging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/meta/" class="md-nav__link">
        meta
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/model_card/" class="md-nav__link">
        model_card
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/params/" class="md-nav__link">
        params
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/plugins/" class="md-nav__link">
        plugins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/push_to_hf/" class="md-nav__link">
        push_to_hf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/registrable/" class="md-nav__link">
        registrable
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/sequences/" class="md-nav__link">
        sequences
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/task_card/" class="md-nav__link">
        task_card
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_15" type="checkbox" id="__nav_4_2_15" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2_15">
          testing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="testing" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_2_15">
          <span class="md-nav__icon md-icon"></span>
          testing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/testing/checklist_test/" class="md-nav__link">
        checklist_test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/testing/confidence_check_test/" class="md-nav__link">
        confidence_check_test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/testing/distributed_test/" class="md-nav__link">
        distributed_test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/testing/interpret_test/" class="md-nav__link">
        interpret_test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/testing/model_test_case/" class="md-nav__link">
        model_test_case
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/testing/test_case/" class="md-nav__link">
        test_case
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/tqdm/" class="md-nav__link">
        tqdm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/util/" class="md-nav__link">
        util
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          confidence_checks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="confidence_checks" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          confidence_checks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../confidence_checks/normalization_bias_verification/" class="md-nav__link">
        normalization_bias_verification
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_2" type="checkbox" id="__nav_4_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_2">
          task_checklists
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="task_checklists" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_2">
          <span class="md-nav__icon md-icon"></span>
          task_checklists
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../confidence_checks/task_checklists/question_answering_suite/" class="md-nav__link">
        question_answering_suite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../confidence_checks/task_checklists/sentiment_analysis_suite/" class="md-nav__link">
        sentiment_analysis_suite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../confidence_checks/task_checklists/task_suite/" class="md-nav__link">
        task_suite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../confidence_checks/task_checklists/textual_entailment_suite/" class="md-nav__link">
        textual_entailment_suite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../confidence_checks/task_checklists/utils/" class="md-nav__link">
        utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../confidence_checks/verification_base/" class="md-nav__link">
        verification_base
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4">
          data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="data" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/batch/" class="md-nav__link">
        batch
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4_2" type="checkbox" id="__nav_4_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4_2">
          data_loaders
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="data_loaders" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_4_2">
          <span class="md-nav__icon md-icon"></span>
          data_loaders
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/data_loaders/data_collator/" class="md-nav__link">
        data_collator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/data_loaders/data_loader/" class="md-nav__link">
        data_loader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/data_loaders/multiprocess_data_loader/" class="md-nav__link">
        multiprocess_data_loader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/data_loaders/multitask_data_loader/" class="md-nav__link">
        multitask_data_loader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/data_loaders/multitask_epoch_sampler/" class="md-nav__link">
        multitask_epoch_sampler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/data_loaders/multitask_scheduler/" class="md-nav__link">
        multitask_scheduler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/data_loaders/simple_data_loader/" class="md-nav__link">
        simple_data_loader
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4_3" type="checkbox" id="__nav_4_4_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4_3">
          dataset_readers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="dataset_readers" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_4_3">
          <span class="md-nav__icon md-icon"></span>
          dataset_readers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/dataset_readers/babi/" class="md-nav__link">
        babi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/dataset_readers/conll2003/" class="md-nav__link">
        conll2003
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/dataset_readers/dataset_reader/" class="md-nav__link">
        dataset_reader
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4_3_4" type="checkbox" id="__nav_4_4_3_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4_3_4">
          dataset_utils
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="dataset_utils" data-md-level="4">
        <label class="md-nav__title" for="__nav_4_4_3_4">
          <span class="md-nav__icon md-icon"></span>
          dataset_utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/dataset_readers/dataset_utils/span_utils/" class="md-nav__link">
        span_utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/dataset_readers/interleaving_dataset_reader/" class="md-nav__link">
        interleaving_dataset_reader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/dataset_readers/multitask/" class="md-nav__link">
        multitask
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/dataset_readers/sequence_tagging/" class="md-nav__link">
        sequence_tagging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/dataset_readers/sharded_dataset_reader/" class="md-nav__link">
        sharded_dataset_reader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/dataset_readers/text_classification_json/" class="md-nav__link">
        text_classification_json
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4_4" type="checkbox" id="__nav_4_4_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4_4">
          fields
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="fields" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_4_4">
          <span class="md-nav__icon md-icon"></span>
          fields
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/adjacency_field/" class="md-nav__link">
        adjacency_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/array_field/" class="md-nav__link">
        array_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/field/" class="md-nav__link">
        field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/flag_field/" class="md-nav__link">
        flag_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/index_field/" class="md-nav__link">
        index_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/label_field/" class="md-nav__link">
        label_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/list_field/" class="md-nav__link">
        list_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/metadata_field/" class="md-nav__link">
        metadata_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/multilabel_field/" class="md-nav__link">
        multilabel_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/namespace_swapping_field/" class="md-nav__link">
        namespace_swapping_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/sequence_field/" class="md-nav__link">
        sequence_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/sequence_label_field/" class="md-nav__link">
        sequence_label_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/span_field/" class="md-nav__link">
        span_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/tensor_field/" class="md-nav__link">
        tensor_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/text_field/" class="md-nav__link">
        text_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/fields/transformer_text_field/" class="md-nav__link">
        transformer_text_field
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/image_loader/" class="md-nav__link">
        image_loader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/instance/" class="md-nav__link">
        instance
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4_7" type="checkbox" id="__nav_4_4_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4_7">
          samplers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="samplers" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_4_7">
          <span class="md-nav__icon md-icon"></span>
          samplers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/samplers/batch_sampler/" class="md-nav__link">
        batch_sampler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/samplers/bucket_batch_sampler/" class="md-nav__link">
        bucket_batch_sampler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/samplers/max_tokens_batch_sampler/" class="md-nav__link">
        max_tokens_batch_sampler
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4_8" type="checkbox" id="__nav_4_4_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4_8">
          token_indexers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="token_indexers" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_4_8">
          <span class="md-nav__icon md-icon"></span>
          token_indexers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/token_indexers/elmo_indexer/" class="md-nav__link">
        elmo_indexer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/token_indexers/pretrained_transformer_indexer/" class="md-nav__link">
        pretrained_transformer_indexer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/token_indexers/pretrained_transformer_mismatched_indexer/" class="md-nav__link">
        pretrained_transformer_mismatched_indexer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/token_indexers/single_id_token_indexer/" class="md-nav__link">
        single_id_token_indexer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/token_indexers/spacy_indexer/" class="md-nav__link">
        spacy_indexer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/token_indexers/token_characters_indexer/" class="md-nav__link">
        token_characters_indexer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/token_indexers/token_indexer/" class="md-nav__link">
        token_indexer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4_9" type="checkbox" id="__nav_4_4_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4_9">
          tokenizers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="tokenizers" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_4_9">
          <span class="md-nav__icon md-icon"></span>
          tokenizers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/tokenizers/character_tokenizer/" class="md-nav__link">
        character_tokenizer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/tokenizers/letters_digits_tokenizer/" class="md-nav__link">
        letters_digits_tokenizer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/tokenizers/pretrained_transformer_tokenizer/" class="md-nav__link">
        pretrained_transformer_tokenizer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/tokenizers/sentence_splitter/" class="md-nav__link">
        sentence_splitter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/tokenizers/spacy_tokenizer/" class="md-nav__link">
        spacy_tokenizer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/tokenizers/token_class/" class="md-nav__link">
        token_class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/tokenizers/tokenizer/" class="md-nav__link">
        tokenizer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/tokenizers/whitespace_tokenizer/" class="md-nav__link">
        whitespace_tokenizer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/vocabulary/" class="md-nav__link">
        vocabulary
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_5">
          evaluation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="evaluation" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          evaluation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/evaluator/" class="md-nav__link">
        evaluator
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5_2" type="checkbox" id="__nav_4_5_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_5_2">
          serializers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="serializers" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_5_2">
          <span class="md-nav__icon md-icon"></span>
          serializers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/serializers/serializers/" class="md-nav__link">
        serializers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_6" type="checkbox" id="__nav_4_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_6">
          fairness
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="fairness" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          fairness
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fairness/adversarial_bias_mitigator/" class="md-nav__link">
        adversarial_bias_mitigator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fairness/bias_direction/" class="md-nav__link">
        bias_direction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fairness/bias_direction_wrappers/" class="md-nav__link">
        bias_direction_wrappers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fairness/bias_metrics/" class="md-nav__link">
        bias_metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fairness/bias_mitigator_applicator/" class="md-nav__link">
        bias_mitigator_applicator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fairness/bias_mitigator_wrappers/" class="md-nav__link">
        bias_mitigator_wrappers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fairness/bias_mitigators/" class="md-nav__link">
        bias_mitigators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fairness/bias_utils/" class="md-nav__link">
        bias_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fairness/fairness_metrics/" class="md-nav__link">
        fairness_metrics
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_7" type="checkbox" id="__nav_4_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_7">
          interpret
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="interpret" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_7">
          <span class="md-nav__icon md-icon"></span>
          interpret
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_7_1" type="checkbox" id="__nav_4_7_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_7_1">
          attackers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="attackers" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_7_1">
          <span class="md-nav__icon md-icon"></span>
          attackers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interpret/attackers/attacker/" class="md-nav__link">
        attacker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interpret/attackers/hotflip/" class="md-nav__link">
        hotflip
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interpret/attackers/input_reduction/" class="md-nav__link">
        input_reduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interpret/attackers/utils/" class="md-nav__link">
        utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_7_2" type="checkbox" id="__nav_4_7_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_7_2">
          influence_interpreters
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="influence_interpreters" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_7_2">
          <span class="md-nav__icon md-icon"></span>
          influence_interpreters
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interpret/influence_interpreters/influence_interpreter/" class="md-nav__link">
        influence_interpreter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interpret/influence_interpreters/simple_influence/" class="md-nav__link">
        simple_influence
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_7_3" type="checkbox" id="__nav_4_7_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_7_3">
          saliency_interpreters
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="saliency_interpreters" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_7_3">
          <span class="md-nav__icon md-icon"></span>
          saliency_interpreters
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interpret/saliency_interpreters/integrated_gradient/" class="md-nav__link">
        integrated_gradient
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interpret/saliency_interpreters/saliency_interpreter/" class="md-nav__link">
        saliency_interpreter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interpret/saliency_interpreters/simple_gradient/" class="md-nav__link">
        simple_gradient
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../interpret/saliency_interpreters/smooth_gradient/" class="md-nav__link">
        smooth_gradient
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_8" type="checkbox" id="__nav_4_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_8">
          models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="models" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_8">
          <span class="md-nav__icon md-icon"></span>
          models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/archival/" class="md-nav__link">
        archival
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/basic_classifier/" class="md-nav__link">
        basic_classifier
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_8_3" type="checkbox" id="__nav_4_8_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_8_3">
          heads
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="heads" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_8_3">
          <span class="md-nav__icon md-icon"></span>
          heads
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/heads/classifier_head/" class="md-nav__link">
        classifier_head
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/heads/head/" class="md-nav__link">
        head
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/model/" class="md-nav__link">
        model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/multitask/" class="md-nav__link">
        multitask
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/simple_tagger/" class="md-nav__link">
        simple_tagger
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9" type="checkbox" id="__nav_4_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_9">
          modules
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="modules" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_9">
          <span class="md-nav__icon md-icon"></span>
          modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9_1" type="checkbox" id="__nav_4_9_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_9_1">
          attention
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="attention" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_9_1">
          <span class="md-nav__icon md-icon"></span>
          attention
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/attention/additive_attention/" class="md-nav__link">
        additive_attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/attention/attention/" class="md-nav__link">
        attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/attention/bilinear_attention/" class="md-nav__link">
        bilinear_attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/attention/cosine_attention/" class="md-nav__link">
        cosine_attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/attention/dot_product_attention/" class="md-nav__link">
        dot_product_attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/attention/linear_attention/" class="md-nav__link">
        linear_attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/attention/scaled_dot_product_attention/" class="md-nav__link">
        scaled_dot_product_attention
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/augmented_lstm/" class="md-nav__link">
        augmented_lstm
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9_3" type="checkbox" id="__nav_4_9_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_9_3">
          backbones
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="backbones" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_9_3">
          <span class="md-nav__icon md-icon"></span>
          backbones
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/backbones/backbone/" class="md-nav__link">
        backbone
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/backbones/pretrained_transformer_backbone/" class="md-nav__link">
        pretrained_transformer_backbone
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/backbones/vilbert_backbone/" class="md-nav__link">
        vilbert_backbone
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/bimpm_matching/" class="md-nav__link">
        bimpm_matching
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9_5" type="checkbox" id="__nav_4_9_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_9_5">
          conditional_random_field
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="conditional_random_field" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_9_5">
          <span class="md-nav__icon md-icon"></span>
          conditional_random_field
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/conditional_random_field/conditional_random_field/" class="md-nav__link">
        conditional_random_field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/conditional_random_field/conditional_random_field_wemission/" class="md-nav__link">
        conditional_random_field_wemission
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/conditional_random_field/conditional_random_field_wlannoy/" class="md-nav__link">
        conditional_random_field_wlannoy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/conditional_random_field/conditional_random_field_wtrans/" class="md-nav__link">
        conditional_random_field_wtrans
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/elmo/" class="md-nav__link">
        elmo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/elmo_lstm/" class="md-nav__link">
        elmo_lstm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/encoder_base/" class="md-nav__link">
        encoder_base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/feedforward/" class="md-nav__link">
        feedforward
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/gated_sum/" class="md-nav__link">
        gated_sum
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/highway/" class="md-nav__link">
        highway
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/input_variational_dropout/" class="md-nav__link">
        input_variational_dropout
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/layer_norm/" class="md-nav__link">
        layer_norm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/lstm_cell_with_projection/" class="md-nav__link">
        lstm_cell_with_projection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/masked_layer_norm/" class="md-nav__link">
        masked_layer_norm
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9_16" type="checkbox" id="__nav_4_9_16" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_9_16">
          matrix_attention
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="matrix_attention" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_9_16">
          <span class="md-nav__icon md-icon"></span>
          matrix_attention
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/matrix_attention/bilinear_matrix_attention/" class="md-nav__link">
        bilinear_matrix_attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/matrix_attention/cosine_matrix_attention/" class="md-nav__link">
        cosine_matrix_attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/matrix_attention/dot_product_matrix_attention/" class="md-nav__link">
        dot_product_matrix_attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/matrix_attention/linear_matrix_attention/" class="md-nav__link">
        linear_matrix_attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/matrix_attention/matrix_attention/" class="md-nav__link">
        matrix_attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/matrix_attention/scaled_dot_product_matrix_attention/" class="md-nav__link">
        scaled_dot_product_matrix_attention
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/maxout/" class="md-nav__link">
        maxout
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/residual_with_layer_dropout/" class="md-nav__link">
        residual_with_layer_dropout
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/sampled_softmax_loss/" class="md-nav__link">
        sampled_softmax_loss
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/scalar_mix/" class="md-nav__link">
        scalar_mix
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9_21" type="checkbox" id="__nav_4_9_21" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_9_21">
          seq2seq_encoders
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="seq2seq_encoders" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_9_21">
          <span class="md-nav__icon md-icon"></span>
          seq2seq_encoders
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2seq_encoders/compose_encoder/" class="md-nav__link">
        compose_encoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2seq_encoders/feedforward_encoder/" class="md-nav__link">
        feedforward_encoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2seq_encoders/gated_cnn_encoder/" class="md-nav__link">
        gated_cnn_encoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2seq_encoders/pass_through_encoder/" class="md-nav__link">
        pass_through_encoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2seq_encoders/pytorch_seq2seq_wrapper/" class="md-nav__link">
        pytorch_seq2seq_wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2seq_encoders/pytorch_transformer_wrapper/" class="md-nav__link">
        pytorch_transformer_wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2seq_encoders/seq2seq_encoder/" class="md-nav__link">
        seq2seq_encoder
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9_22" type="checkbox" id="__nav_4_9_22" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_9_22">
          seq2vec_encoders
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="seq2vec_encoders" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_9_22">
          <span class="md-nav__icon md-icon"></span>
          seq2vec_encoders
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2vec_encoders/bert_pooler/" class="md-nav__link">
        bert_pooler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2vec_encoders/boe_encoder/" class="md-nav__link">
        boe_encoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2vec_encoders/cls_pooler/" class="md-nav__link">
        cls_pooler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2vec_encoders/cnn_encoder/" class="md-nav__link">
        cnn_encoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2vec_encoders/cnn_highway_encoder/" class="md-nav__link">
        cnn_highway_encoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2vec_encoders/pytorch_seq2vec_wrapper/" class="md-nav__link">
        pytorch_seq2vec_wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/seq2vec_encoders/seq2vec_encoder/" class="md-nav__link">
        seq2vec_encoder
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/softmax_loss/" class="md-nav__link">
        softmax_loss
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9_24" type="checkbox" id="__nav_4_9_24" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_9_24">
          span_extractors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="span_extractors" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_9_24">
          <span class="md-nav__icon md-icon"></span>
          span_extractors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/span_extractors/bidirectional_endpoint_span_extractor/" class="md-nav__link">
        bidirectional_endpoint_span_extractor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/span_extractors/endpoint_span_extractor/" class="md-nav__link">
        endpoint_span_extractor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/span_extractors/max_pooling_span_extractor/" class="md-nav__link">
        max_pooling_span_extractor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/span_extractors/self_attentive_span_extractor/" class="md-nav__link">
        self_attentive_span_extractor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/span_extractors/span_extractor/" class="md-nav__link">
        span_extractor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/span_extractors/span_extractor_with_span_width_embedding/" class="md-nav__link">
        span_extractor_with_span_width_embedding
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/stacked_alternating_lstm/" class="md-nav__link">
        stacked_alternating_lstm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/stacked_bidirectional_lstm/" class="md-nav__link">
        stacked_bidirectional_lstm
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9_27" type="checkbox" id="__nav_4_9_27" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_9_27">
          text_field_embedders
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="text_field_embedders" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_9_27">
          <span class="md-nav__icon md-icon"></span>
          text_field_embedders
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/text_field_embedders/basic_text_field_embedder/" class="md-nav__link">
        basic_text_field_embedder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/text_field_embedders/text_field_embedder/" class="md-nav__link">
        text_field_embedder
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/time_distributed/" class="md-nav__link">
        time_distributed
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9_29" type="checkbox" id="__nav_4_9_29" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_9_29">
          token_embedders
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="token_embedders" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_9_29">
          <span class="md-nav__icon md-icon"></span>
          token_embedders
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/token_embedders/bag_of_word_counts_token_embedder/" class="md-nav__link">
        bag_of_word_counts_token_embedder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/token_embedders/elmo_token_embedder/" class="md-nav__link">
        elmo_token_embedder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/token_embedders/embedding/" class="md-nav__link">
        embedding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/token_embedders/empty_embedder/" class="md-nav__link">
        empty_embedder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/token_embedders/pass_through_token_embedder/" class="md-nav__link">
        pass_through_token_embedder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/token_embedders/pretrained_transformer_embedder/" class="md-nav__link">
        pretrained_transformer_embedder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/token_embedders/pretrained_transformer_mismatched_embedder/" class="md-nav__link">
        pretrained_transformer_mismatched_embedder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/token_embedders/token_characters_encoder/" class="md-nav__link">
        token_characters_encoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/token_embedders/token_embedder/" class="md-nav__link">
        token_embedder
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9_30" type="checkbox" id="__nav_4_9_30" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_9_30">
          transformer
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="transformer" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_9_30">
          <span class="md-nav__icon md-icon"></span>
          transformer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/activation_layer/" class="md-nav__link">
        activation_layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/attention_module/" class="md-nav__link">
        attention_module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/bimodal_attention/" class="md-nav__link">
        bimodal_attention
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/bimodal_connection_layer/" class="md-nav__link">
        bimodal_connection_layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/bimodal_encoder/" class="md-nav__link">
        bimodal_encoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/layer_norm/" class="md-nav__link">
        layer_norm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/output_layer/" class="md-nav__link">
        output_layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/positional_encoding/" class="md-nav__link">
        positional_encoding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/t5/" class="md-nav__link">
        t5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/transformer_embeddings/" class="md-nav__link">
        transformer_embeddings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/transformer_layer/" class="md-nav__link">
        transformer_layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/transformer_module/" class="md-nav__link">
        transformer_module
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/transformer_pooler/" class="md-nav__link">
        transformer_pooler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/transformer_stack/" class="md-nav__link">
        transformer_stack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/transformer/util/" class="md-nav__link">
        util
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/util/" class="md-nav__link">
        util
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_9_32" type="checkbox" id="__nav_4_9_32" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_9_32">
          vision
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="vision" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_9_32">
          <span class="md-nav__icon md-icon"></span>
          vision
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/vision/grid_embedder/" class="md-nav__link">
        grid_embedder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/vision/image2image/" class="md-nav__link">
        image2image
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/vision/region_detector/" class="md-nav__link">
        region_detector
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_10">
          nn
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="nn" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          nn
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../activations/" class="md-nav__link">
        activations
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          beam_search
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        beam_search
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#statetype" class="md-nav__link">
    StateType
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stepfunctiontypewithtimestep" class="md-nav__link">
    StepFunctionTypeWithTimestep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stepfunctiontypenotimestep" class="md-nav__link">
    StepFunctionTypeNoTimestep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stepfunctiontype" class="md-nav__link">
    StepFunctionType
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constraintstatetype" class="md-nav__link">
    ConstraintStateType
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sampler" class="md-nav__link">
    Sampler
  </a>
  
    <nav class="md-nav" aria-label="Sampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default_implementation" class="md-nav__link">
    default95implementation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#init_state" class="md-nav__link">
    init95state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_nodes" class="md-nav__link">
    sample95nodes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_beams" class="md-nav__link">
    sample95beams
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deterministicsampler" class="md-nav__link">
    DeterministicSampler
  </a>
  
    <nav class="md-nav" aria-label="DeterministicSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample_nodes_1" class="md-nav__link">
    sample95nodes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multinomialsampler" class="md-nav__link">
    MultinomialSampler
  </a>
  
    <nav class="md-nav" aria-label="MultinomialSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample_nodes_2" class="md-nav__link">
    sample95nodes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#topksampler" class="md-nav__link">
    TopKSampler
  </a>
  
    <nav class="md-nav" aria-label="TopKSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample_nodes_3" class="md-nav__link">
    sample95nodes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toppsampler" class="md-nav__link">
    TopPSampler
  </a>
  
    <nav class="md-nav" aria-label="TopPSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample_nodes_4" class="md-nav__link">
    sample95nodes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gumbelsampler" class="md-nav__link">
    GumbelSampler
  </a>
  
    <nav class="md-nav" aria-label="GumbelSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#init_state_1" class="md-nav__link">
    init95state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_nodes_5" class="md-nav__link">
    sample95nodes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_beams_1" class="md-nav__link">
    sample95beams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gumbel" class="md-nav__link">
    gumbel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gumbel_with_max" class="md-nav__link">
    gumbel95with95max
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finalsequencescorer" class="md-nav__link">
    FinalSequenceScorer
  </a>
  
    <nav class="md-nav" aria-label="FinalSequenceScorer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default_implementation_1" class="md-nav__link">
    default95implementation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#score" class="md-nav__link">
    score
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequencelogprobabilityscorer" class="md-nav__link">
    SequenceLogProbabilityScorer
  </a>
  
    <nav class="md-nav" aria-label="SequenceLogProbabilityScorer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#score_1" class="md-nav__link">
    score
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lengthnormalizedsequencelogprobabilityscorer" class="md-nav__link">
    LengthNormalizedSequenceLogProbabilityScorer
  </a>
  
    <nav class="md-nav" aria-label="LengthNormalizedSequenceLogProbabilityScorer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#score_2" class="md-nav__link">
    score
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constraint" class="md-nav__link">
    Constraint
  </a>
  
    <nav class="md-nav" aria-label="Constraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#init_state_2" class="md-nav__link">
    init95state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apply" class="md-nav__link">
    apply
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_state" class="md-nav__link">
    update95state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_update_state" class="md-nav__link">
    95update95state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repeatedngramblockingconstraint" class="md-nav__link">
    RepeatedNGramBlockingConstraint
  </a>
  
    <nav class="md-nav" aria-label="RepeatedNGramBlockingConstraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#init_state_3" class="md-nav__link">
    init95state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apply_1" class="md-nav__link">
    apply
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beamsearch" class="md-nav__link">
    BeamSearch
  </a>
  
    <nav class="md-nav" aria-label="BeamSearch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default_implementation_2" class="md-nav__link">
    default95implementation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#search" class="md-nav__link">
    search
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10_3" type="checkbox" id="__nav_4_10_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_10_3">
          checkpoint
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="checkpoint" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_10_3">
          <span class="md-nav__icon md-icon"></span>
          checkpoint
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../checkpoint/checkpoint_wrapper/" class="md-nav__link">
        checkpoint_wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../checkpoint/fairscale_checkpoint_wrapper/" class="md-nav__link">
        fairscale_checkpoint_wrapper
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../chu_liu_edmonds/" class="md-nav__link">
        chu_liu_edmonds
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../initializers/" class="md-nav__link">
        initializers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../module/" class="md-nav__link">
        module
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10_7" type="checkbox" id="__nav_4_10_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_10_7">
          parallel
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="parallel" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_10_7">
          <span class="md-nav__icon md-icon"></span>
          parallel
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../parallel/ddp_accelerator/" class="md-nav__link">
        ddp_accelerator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../parallel/fairscale_fsdp_accelerator/" class="md-nav__link">
        fairscale_fsdp_accelerator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../parallel/sharded_module_mixin/" class="md-nav__link">
        sharded_module_mixin
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10_8" type="checkbox" id="__nav_4_10_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_10_8">
          regularizers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="regularizers" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_10_8">
          <span class="md-nav__icon md-icon"></span>
          regularizers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../regularizers/regularizer/" class="md-nav__link">
        regularizer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../regularizers/regularizer_applicator/" class="md-nav__link">
        regularizer_applicator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../regularizers/regularizers/" class="md-nav__link">
        regularizers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/" class="md-nav__link">
        util
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_11">
          predictors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="predictors" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          predictors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../predictors/multitask/" class="md-nav__link">
        multitask
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../predictors/predictor/" class="md-nav__link">
        predictor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../predictors/sentence_tagger/" class="md-nav__link">
        sentence_tagger
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../predictors/text_classifier/" class="md-nav__link">
        text_classifier
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_12" type="checkbox" id="__nav_4_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_12">
          tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="tools" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/archive_surgery/" class="md-nav__link">
        archive_surgery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/create_elmo_embeddings_from_vocab/" class="md-nav__link">
        create_elmo_embeddings_from_vocab
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/inspect_cache/" class="md-nav__link">
        inspect_cache
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13" type="checkbox" id="__nav_4_13" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_13">
          training
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="training" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_13">
          <span class="md-nav__icon md-icon"></span>
          training
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13_1" type="checkbox" id="__nav_4_13_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_13_1">
          callbacks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="callbacks" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_13_1">
          <span class="md-nav__icon md-icon"></span>
          callbacks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/callbacks/backward/" class="md-nav__link">
        backward
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/callbacks/callback/" class="md-nav__link">
        callback
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/callbacks/confidence_checks/" class="md-nav__link">
        confidence_checks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/callbacks/console_logger/" class="md-nav__link">
        console_logger
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/callbacks/log_writer/" class="md-nav__link">
        log_writer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/callbacks/should_validate/" class="md-nav__link">
        should_validate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/callbacks/tensorboard/" class="md-nav__link">
        tensorboard
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/callbacks/track_epoch/" class="md-nav__link">
        track_epoch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/callbacks/wandb/" class="md-nav__link">
        wandb
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/checkpointer/" class="md-nav__link">
        checkpointer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/gradient_descent_trainer/" class="md-nav__link">
        gradient_descent_trainer
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13_4" type="checkbox" id="__nav_4_13_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_13_4">
          learning_rate_schedulers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="learning_rate_schedulers" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_13_4">
          <span class="md-nav__icon md-icon"></span>
          learning_rate_schedulers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/learning_rate_schedulers/combined/" class="md-nav__link">
        combined
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/learning_rate_schedulers/cosine/" class="md-nav__link">
        cosine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/learning_rate_schedulers/learning_rate_scheduler/" class="md-nav__link">
        learning_rate_scheduler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/learning_rate_schedulers/linear_with_warmup/" class="md-nav__link">
        linear_with_warmup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/learning_rate_schedulers/noam/" class="md-nav__link">
        noam
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/learning_rate_schedulers/polynomial_decay/" class="md-nav__link">
        polynomial_decay
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/learning_rate_schedulers/pytorch_lr_schedulers/" class="md-nav__link">
        pytorch_lr_schedulers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/learning_rate_schedulers/slanted_triangular/" class="md-nav__link">
        slanted_triangular
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metric_tracker/" class="md-nav__link">
        metric_tracker
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13_6" type="checkbox" id="__nav_4_13_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_13_6">
          metrics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="metrics" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_13_6">
          <span class="md-nav__icon md-icon"></span>
          metrics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/attachment_scores/" class="md-nav__link">
        attachment_scores
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/auc/" class="md-nav__link">
        auc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/average/" class="md-nav__link">
        average
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/bleu/" class="md-nav__link">
        bleu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/boolean_accuracy/" class="md-nav__link">
        boolean_accuracy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/categorical_accuracy/" class="md-nav__link">
        categorical_accuracy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/covariance/" class="md-nav__link">
        covariance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/entropy/" class="md-nav__link">
        entropy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/evalb_bracketing_scorer/" class="md-nav__link">
        evalb_bracketing_scorer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/f1_measure/" class="md-nav__link">
        f1_measure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/fbeta_measure/" class="md-nav__link">
        fbeta_measure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/fbeta_multi_label_measure/" class="md-nav__link">
        fbeta_multi_label_measure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/fbeta_verbose_measure/" class="md-nav__link">
        fbeta_verbose_measure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/mean_absolute_error/" class="md-nav__link">
        mean_absolute_error
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/metric/" class="md-nav__link">
        metric
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/pearson_correlation/" class="md-nav__link">
        pearson_correlation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/perplexity/" class="md-nav__link">
        perplexity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/rouge/" class="md-nav__link">
        rouge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/sequence_accuracy/" class="md-nav__link">
        sequence_accuracy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/span_based_f1_measure/" class="md-nav__link">
        span_based_f1_measure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/spearman_correlation/" class="md-nav__link">
        spearman_correlation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/metrics/unigram_recall/" class="md-nav__link">
        unigram_recall
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_13_7" type="checkbox" id="__nav_4_13_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_13_7">
          momentum_schedulers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="momentum_schedulers" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_13_7">
          <span class="md-nav__icon md-icon"></span>
          momentum_schedulers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/momentum_schedulers/inverted_triangular/" class="md-nav__link">
        inverted_triangular
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/momentum_schedulers/momentum_scheduler/" class="md-nav__link">
        momentum_scheduler
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/moving_average/" class="md-nav__link">
        moving_average
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/no_op_trainer/" class="md-nav__link">
        no_op_trainer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/optimizers/" class="md-nav__link">
        optimizers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/scheduler/" class="md-nav__link">
        scheduler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/trainer/" class="md-nav__link">
        trainer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training/util/" class="md-nav__link">
        util
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG/" class="md-nav__link">
        CHANGELOG
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://raw.githubusercontent.com/allenai/allennlp/main/LICENSE" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#statetype" class="md-nav__link">
    StateType
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stepfunctiontypewithtimestep" class="md-nav__link">
    StepFunctionTypeWithTimestep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stepfunctiontypenotimestep" class="md-nav__link">
    StepFunctionTypeNoTimestep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stepfunctiontype" class="md-nav__link">
    StepFunctionType
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constraintstatetype" class="md-nav__link">
    ConstraintStateType
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sampler" class="md-nav__link">
    Sampler
  </a>
  
    <nav class="md-nav" aria-label="Sampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default_implementation" class="md-nav__link">
    default95implementation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#init_state" class="md-nav__link">
    init95state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_nodes" class="md-nav__link">
    sample95nodes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_beams" class="md-nav__link">
    sample95beams
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deterministicsampler" class="md-nav__link">
    DeterministicSampler
  </a>
  
    <nav class="md-nav" aria-label="DeterministicSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample_nodes_1" class="md-nav__link">
    sample95nodes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multinomialsampler" class="md-nav__link">
    MultinomialSampler
  </a>
  
    <nav class="md-nav" aria-label="MultinomialSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample_nodes_2" class="md-nav__link">
    sample95nodes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#topksampler" class="md-nav__link">
    TopKSampler
  </a>
  
    <nav class="md-nav" aria-label="TopKSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample_nodes_3" class="md-nav__link">
    sample95nodes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toppsampler" class="md-nav__link">
    TopPSampler
  </a>
  
    <nav class="md-nav" aria-label="TopPSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample_nodes_4" class="md-nav__link">
    sample95nodes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gumbelsampler" class="md-nav__link">
    GumbelSampler
  </a>
  
    <nav class="md-nav" aria-label="GumbelSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#init_state_1" class="md-nav__link">
    init95state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_nodes_5" class="md-nav__link">
    sample95nodes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_beams_1" class="md-nav__link">
    sample95beams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gumbel" class="md-nav__link">
    gumbel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gumbel_with_max" class="md-nav__link">
    gumbel95with95max
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finalsequencescorer" class="md-nav__link">
    FinalSequenceScorer
  </a>
  
    <nav class="md-nav" aria-label="FinalSequenceScorer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default_implementation_1" class="md-nav__link">
    default95implementation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#score" class="md-nav__link">
    score
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequencelogprobabilityscorer" class="md-nav__link">
    SequenceLogProbabilityScorer
  </a>
  
    <nav class="md-nav" aria-label="SequenceLogProbabilityScorer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#score_1" class="md-nav__link">
    score
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lengthnormalizedsequencelogprobabilityscorer" class="md-nav__link">
    LengthNormalizedSequenceLogProbabilityScorer
  </a>
  
    <nav class="md-nav" aria-label="LengthNormalizedSequenceLogProbabilityScorer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#score_2" class="md-nav__link">
    score
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constraint" class="md-nav__link">
    Constraint
  </a>
  
    <nav class="md-nav" aria-label="Constraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#init_state_2" class="md-nav__link">
    init95state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apply" class="md-nav__link">
    apply
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_state" class="md-nav__link">
    update95state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_update_state" class="md-nav__link">
    95update95state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repeatedngramblockingconstraint" class="md-nav__link">
    RepeatedNGramBlockingConstraint
  </a>
  
    <nav class="md-nav" aria-label="RepeatedNGramBlockingConstraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#init_state_3" class="md-nav__link">
    init95state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apply_1" class="md-nav__link">
    apply
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beamsearch" class="md-nav__link">
    BeamSearch
  </a>
  
    <nav class="md-nav" aria-label="BeamSearch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default_implementation_2" class="md-nav__link">
    default95implementation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#search" class="md-nav__link">
    search
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>beam_search</h1>

<div>
 <p class="alignleft"><i>allennlp</i><i>.nn</i><strong>.beam_search</strong></p>
 <p class="alignright"><a class="sourcelink" href="https://github.com/allenai/allennlp/blob/v2.10.1/allennlp/nn/beam_search.py">[SOURCE]</a></p>
</div>
<div style="clear: both;"></div>

<hr />
<p><a id="allennlp.nn.beam_search.StateType"></a></p>
<h2 id="statetype">StateType<a class="headerlink" href="#statetype" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">StateType</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.StepFunctionTypeWithTimestep"></a></p>
<h2 id="stepfunctiontypewithtimestep">StepFunctionTypeWithTimestep<a class="headerlink" href="#stepfunctiontypewithtimestep" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">StepFunctionTypeWithTimestep</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[</span>
    <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">StateType</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">StateType</span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.StepFunctionTypeNoTimestep"></a></p>
<h2 id="stepfunctiontypenotimestep">StepFunctionTypeNoTimestep<a class="headerlink" href="#stepfunctiontypenotimestep" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">StepFunctionTypeNoTimestep</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">StateType</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">StateType</span><span class="p">]]</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.StepFunctionType"></a></p>
<h2 id="stepfunctiontype">StepFunctionType<a class="headerlink" href="#stepfunctiontype" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">StepFunctionType</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span>
    <span class="s2">&quot;StepFunctionType&quot;</span><span class="p">,</span> <span class="n">StepFunctionTypeWithTimestep</span><span class="p">,</span> <span class="n">StepFunctionTypeNoTimestep</span>
<span class="p">)</span>
</code></pre></div>
<p>The type of step function that can be passed to <a href="#search"><code>BeamSearch.search</code></a>.</p>
<p>This can either be <a href="#stepfunctiontypewithtimestep"><code>StepFunctionTypeWithTimestep</code></a>
or <a href="#stepfunctiontypenotimestep"><code>StepFunctionTypeNoTimestep</code></a>.</p>
<p><a id="allennlp.nn.beam_search.ConstraintStateType"></a></p>
<h2 id="constraintstatetype">ConstraintStateType<a class="headerlink" href="#constraintstatetype" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">ConstraintStateType</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.Sampler"></a></p>
<h2 id="sampler">Sampler<a class="headerlink" href="#sampler" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Sampler</span><span class="p">(</span><span class="n">Registrable</span><span class="p">)</span>
</code></pre></div>
<p>An abstract class that can be used to sample candidates (either nodes or beams)
within <code>BeamSearch</code>.</p>
<p>A <code>Sampler</code> just has three methods, <code>init_state()</code>, <code>sample_nodes()</code> and <code>sample_beams()</code>.</p>
<p><code>init_state()</code> takes three arguments:</p>
<ul>
<li>a tensor of starting log probs with shape <code>(batch_size,, num_classes)</code>,</li>
<li>the batch size, an int,</li>
<li>and the number of classes, also an int.</li>
</ul>
<p>It returns a state dictionary with any state tensors needed for subsequent
calls to <code>sample_nodes()</code> and <code>sample_beams()</code>.</p>
<p>By default this method just returns an empty dictionary.</p>
<p>Both <code>sample_nodes()</code> and <code>sample_beams()</code> should take three arguments:</p>
<ul>
<li>tensor of normalized log probabilities with shape <code>(batch_size, num_examples)</code>,</li>
<li>an integer representing the number of samples to take for each example in the batch,</li>
<li>and a state dictionary which could contain any tensors needed for the <code>Sampler</code> to keep
  track of state.</li>
</ul>
<p>For <code>sample_nodes()</code>, <code>num_examples = num_classes</code>, but for <code>sample_beams</code>,
<code>num_examples = beam_size * per_node_beam_size</code>.</p>
<p>The return value should be a tuple containing:</p>
<ul>
<li>a tensor of log probabilities of the sampled examples with shape <code>(batch_size, num_samples)</code>,</li>
<li>a tensor of indices of the sampled examples with shape <code>(batch_size, num_samples)</code>,</li>
<li>and the updated state dictionary.</li>
</ul>
<p>A default implementation of <code>sample_beams</code> is provided, which just deterministically
picks the <code>k</code> examples with highest log probability.</p>
<p><a id="allennlp.nn.beam_search.Sampler.default_implementation"></a></p>
<h3 id="default_implementation">default_implementation<a class="headerlink" href="#default_implementation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Sampler</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="n">default_implementation</span> <span class="o">=</span> <span class="s2">&quot;deterministic&quot;</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.Sampler.init_state"></a></p>
<h3 id="init_state">init_state<a class="headerlink" href="#init_state" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Sampler</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">init_state</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">start_class_log_probabilities</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">num_classes</span><span class="p">:</span> <span class="nb">int</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StateType</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.Sampler.sample_nodes"></a></p>
<h3 id="sample_nodes">sample_nodes<a class="headerlink" href="#sample_nodes" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Sampler</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">sample_nodes</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">log_probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">per_node_beam_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">state</span><span class="p">:</span> <span class="n">StateType</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">StateType</span><span class="p">]</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.Sampler.sample_beams"></a></p>
<h3 id="sample_beams">sample_beams<a class="headerlink" href="#sample_beams" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Sampler</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">sample_beams</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">log_probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">beam_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">state</span><span class="p">:</span> <span class="n">StateType</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">StateType</span><span class="p">]</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.DeterministicSampler"></a></p>
<h2 id="deterministicsampler">DeterministicSampler<a class="headerlink" href="#deterministicsampler" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="nd">@Sampler</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;deterministic&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">DeterministicSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">)</span>
</code></pre></div>
<p>A <code>Sampler</code> that just deterministically returns the <code>k</code> nodes or beams with highest
log probability.</p>
<p><a id="allennlp.nn.beam_search.DeterministicSampler.sample_nodes"></a></p>
<h3 id="sample_nodes_1">sample_nodes<a class="headerlink" href="#sample_nodes_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">DeterministicSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">sample_nodes</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">log_probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">per_node_beam_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">state</span><span class="p">:</span> <span class="n">StateType</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">StateType</span><span class="p">]</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.MultinomialSampler"></a></p>
<h2 id="multinomialsampler">MultinomialSampler<a class="headerlink" href="#multinomialsampler" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="nd">@Sampler</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;multinomial&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">MultinomialSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">):</span>
 <span class="o">|</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">with_replacement</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>A <code>Sampler</code> which samples nodes from the given multinomial distribution. Beams are sampled
in the default, non-deterministic way.</p>
<h4 id="multinomialsampler.parameters">Parameters<a class="headerlink" href="#multinomialsampler.parameters" title="Permanent link">&para;</a></h4>

<ul>
<li><strong>temperature</strong> : <code>float</code>, optional (default = <code>1.0</code>) <br>
    A <code>temperature</code> below 1.0 produces a sharper probability distribution and a <code>temperature</code> above 1.0
    produces a flatter probability distribution.</li>
<li><strong>with_replacement</strong> : <code>bool</code>, optional (default = <code>False</code>) <br>
    Whether to sample with replacement.</li>
</ul>
<p><a id="allennlp.nn.beam_search.MultinomialSampler.sample_nodes"></a></p>
<h3 id="sample_nodes_2">sample_nodes<a class="headerlink" href="#sample_nodes_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">MultinomialSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">sample_nodes</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">log_probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">per_node_beam_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">state</span><span class="p">:</span> <span class="n">StateType</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">StateType</span><span class="p">]</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.TopKSampler"></a></p>
<h2 id="topksampler">TopKSampler<a class="headerlink" href="#topksampler" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="nd">@Sampler</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;top-k&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">TopKSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">):</span>
 <span class="o">|</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">with_replacement</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
 <span class="o">|</span> <span class="p">)</span>
</code></pre></div>
<p>A <code>Sampler</code> which redistributes the probability mass function for nodes among the
top <code>k</code> choices, then samples from that subset after re-normalizing the probabilities.</p>
<p>Beams are sampled in the default, deterministic way.</p>
<h4 id="topksampler.parameters">Parameters<a class="headerlink" href="#topksampler.parameters" title="Permanent link">&para;</a></h4>

<ul>
<li><strong>k</strong> : <code>int</code>, optional (default = <code>1</code>) <br>
    The number of top choices to be selected from.</li>
<li><strong>temperature</strong> : <code>float</code>, optional (default = <code>1.0</code>) <br>
    A <code>temperature</code> below 1.0 produces a sharper probability distribution and a <code>temperature</code>
    above 1.0 produces a flatter probability distribution.</li>
<li><strong>with_replacement</strong> : <code>bool</code>, optional (default = <code>False</code>) <br>
    If set to <code>True</code>, samples will be selected with replacement from the top k choices.</li>
</ul>
<p><a id="allennlp.nn.beam_search.TopKSampler.sample_nodes"></a></p>
<h3 id="sample_nodes_3">sample_nodes<a class="headerlink" href="#sample_nodes_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">TopKSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">sample_nodes</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">log_probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">per_node_beam_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">state</span><span class="p">:</span> <span class="n">StateType</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">StateType</span><span class="p">]</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.TopPSampler"></a></p>
<h2 id="toppsampler">TopPSampler<a class="headerlink" href="#toppsampler" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="nd">@Sampler</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;top-p&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">TopPSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">):</span>
 <span class="o">|</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">with_replacement</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
 <span class="o">|</span> <span class="p">)</span>
</code></pre></div>
<p>A <code>Sampler</code> which redistributes the probability mass function for nodes among
the top choices with a cumulative probability of at least <code>p</code>, then samples from that subset
after re-normalizing the probabilities.</p>
<p>Beams are sampled in the default, deterministic way.</p>
<h4 id="toppsampler.parameters">Parameters<a class="headerlink" href="#toppsampler.parameters" title="Permanent link">&para;</a></h4>

<ul>
<li><strong>p</strong> : <code>float</code>, optional (default = <code>0.9</code>) <br>
    The cumulative probability cutoff threshold. A higher value of <code>p</code> will result in more possible
    examples to sample from. If <code>with_replacement</code> is <code>False</code> and the number of possible samples is
    insufficient to sample without replacement from when calling <code>sample_nodes</code>, then the top
    <code>per_node_beam_size</code> examples will be chosen.</li>
<li><strong>temperature</strong> : <code>float</code>, optional (default = <code>1.0</code>) <br>
    A <code>temperature</code> below 1.0 produces a sharper probability distribution and a <code>temperature</code>
    above 1.0 produces a flatter probability distribution.</li>
<li><strong>with_replacement</strong> : <code>bool</code>, optional (default = <code>False</code>) <br>
    If set to <code>True</code>, samples will be selected with replacement from the top choices.</li>
</ul>
<p><a id="allennlp.nn.beam_search.TopPSampler.sample_nodes"></a></p>
<h3 id="sample_nodes_4">sample_nodes<a class="headerlink" href="#sample_nodes_4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">TopPSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">sample_nodes</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">log_probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">per_node_beam_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">state</span><span class="p">:</span> <span class="n">StateType</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">StateType</span><span class="p">]</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.GumbelSampler"></a></p>
<h2 id="gumbelsampler">GumbelSampler<a class="headerlink" href="#gumbelsampler" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="nd">@Sampler</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;gumbel&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">GumbelSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">):</span>
 <span class="o">|</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
</code></pre></div>
<p>A <code>Sampler</code> which uses the Gumbel-Top-K trick to sample without replacement. See
<a href="https://api.semanticscholar.org/CorpusID:76662039"><em>Stochastic Beams and Where to Find Them: The Gumbel-Top-k Trick for Sampling
Sequences Without Replacement</em>, W Kool, H Van Hoof and M Welling, 2010</a>.</p>
<h4 id="gumbelsampler.parameters">Parameters<a class="headerlink" href="#gumbelsampler.parameters" title="Permanent link">&para;</a></h4>

<ul>
<li><strong>temperature</strong> : <code>float</code>, optional (default = <code>1.0</code>) <br>
    A <code>temperature</code> below 1.0 produces a sharper probability distribution and a <code>temperature</code>
    above 1.0 produces a flatter probability distribution.</li>
</ul>
<p><a id="allennlp.nn.beam_search.GumbelSampler.init_state"></a></p>
<h3 id="init_state_1">init_state<a class="headerlink" href="#init_state_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GumbelSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">init_state</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">start_class_log_probabilities</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">num_classes</span><span class="p">:</span> <span class="nb">int</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StateType</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.GumbelSampler.sample_nodes"></a></p>
<h3 id="sample_nodes_5">sample_nodes<a class="headerlink" href="#sample_nodes_5" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GumbelSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">sample_nodes</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">log_probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">per_node_beam_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">state</span><span class="p">:</span> <span class="n">StateType</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">StateType</span><span class="p">]</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.GumbelSampler.sample_beams"></a></p>
<h3 id="sample_beams_1">sample_beams<a class="headerlink" href="#sample_beams_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GumbelSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">sample_beams</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">log_probs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">beam_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">state</span><span class="p">:</span> <span class="n">StateType</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">StateType</span><span class="p">]</span>
</code></pre></div>
<p>Returns the beams with the highest perturbed log probabilities.</p>
<p><a id="allennlp.nn.beam_search.GumbelSampler.gumbel"></a></p>
<h3 id="gumbel">gumbel<a class="headerlink" href="#gumbel" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GumbelSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">gumbel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>
<p>Sample <code>Gumbel(phi)</code>.</p>
<p><code>phi</code> should have shape <code>(batch_size, num_classes)</code>.</p>
<p><a id="allennlp.nn.beam_search.GumbelSampler.gumbel_with_max"></a></p>
<h3 id="gumbel_with_max">gumbel_with_max<a class="headerlink" href="#gumbel_with_max" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GumbelSampler</span><span class="p">(</span><span class="n">Sampler</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">gumbel_with_max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>
<p>Sample <code>Gumbel(phi)</code> conditioned on the maximum value being equal to <code>T</code>.</p>
<p><code>phi</code> should have shape <code>(batch_size, num_classes)</code> and <code>T</code> should have
shape <code>(batch_size, 1)</code>.</p>
<p><a id="allennlp.nn.beam_search.FinalSequenceScorer"></a></p>
<h2 id="finalsequencescorer">FinalSequenceScorer<a class="headerlink" href="#finalsequencescorer" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">FinalSequenceScorer</span><span class="p">(</span><span class="n">Registrable</span><span class="p">)</span>
</code></pre></div>
<p>An abstract class that can be used to score the final generated sequences found
by beam search. Given the predicted sequences and the corresponding log probabilities of
those sequences, the class calculates and returns the final score of the sequences.</p>
<p>The default implementation scores the sequences using the sum of the log probabilities of
the sequence, which is passed as input.</p>
<p><a id="allennlp.nn.beam_search.FinalSequenceScorer.default_implementation"></a></p>
<h3 id="default_implementation_1">default_implementation<a class="headerlink" href="#default_implementation_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">FinalSequenceScorer</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="n">default_implementation</span> <span class="o">=</span> <span class="s2">&quot;sequence-log-prob&quot;</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.FinalSequenceScorer.score"></a></p>
<h3 id="score">score<a class="headerlink" href="#score" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">FinalSequenceScorer</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">score</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">predictions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">log_probabilities</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>
<p>Score the final predictions found by beam search.</p>
<h4 id="score.parameters">Parameters<a class="headerlink" href="#score.parameters" title="Permanent link">&para;</a></h4>

<ul>
<li>
<p><strong>predictions</strong> : <code>torch.Tensor</code> <br>
    A tensor containing the initial predictions with shape <code>(batch_size, beam_size, max_steps)</code>.</p>
</li>
<li>
<p><strong>log_probabilities</strong> : <code>torch.Tensor</code> <br>
    A tensor containing the log probabilities of the sequence, defined as the sum
    of the log probabilities per token, with shape <code>(batch_size, beam_size)</code>.</p>
</li>
<li>
<p><strong>end_index</strong> : <code>int</code> <br>
    The index of the end symbol.</p>
</li>
</ul>
<h4 id="score.returns">Returns<a class="headerlink" href="#score.returns" title="Permanent link">&para;</a></h4>

<ul>
<li><code>torch.Tensor</code> <br>
    A tensor of the final sequence scores of shape <code>(batch_size, beam_size)</code>.</li>
</ul>
<p><a id="allennlp.nn.beam_search.SequenceLogProbabilityScorer"></a></p>
<h2 id="sequencelogprobabilityscorer">SequenceLogProbabilityScorer<a class="headerlink" href="#sequencelogprobabilityscorer" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="nd">@FinalSequenceScorer</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;sequence-log-prob&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">SequenceLogProbabilityScorer</span><span class="p">(</span><span class="n">FinalSequenceScorer</span><span class="p">)</span>
</code></pre></div>
<p>A <code>FinalSequenceScorer</code> which scores the sequences by the sum of the log probabilities
across the sequence's tokens.</p>
<p><a id="allennlp.nn.beam_search.SequenceLogProbabilityScorer.score"></a></p>
<h3 id="score_1">score<a class="headerlink" href="#score_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">SequenceLogProbabilityScorer</span><span class="p">(</span><span class="n">FinalSequenceScorer</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">score</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">predictions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">log_probabilities</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.LengthNormalizedSequenceLogProbabilityScorer"></a></p>
<h2 id="lengthnormalizedsequencelogprobabilityscorer">LengthNormalizedSequenceLogProbabilityScorer<a class="headerlink" href="#lengthnormalizedsequencelogprobabilityscorer" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="nd">@FinalSequenceScorer</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;length-normalized-sequence-log-prob&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">LengthNormalizedSequenceLogProbabilityScorer</span><span class="p">(</span><span class="n">FinalSequenceScorer</span><span class="p">):</span>
 <span class="o">|</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_penalty</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
</code></pre></div>
<p>A <code>FinalSequenceScorer</code> which scores the sequences by the average log probability of the
tokens in the sequence. It optionally includes a length penalty which promotes
or demotes sequences based on their lengths. The final score for a sequence will
be <code>(sequence_log_probability) / (sequence_length ** length_penalty)</code>. The sequence length
here includes the end token.</p>
<h4 id="lengthnormalizedsequencelogprobabilityscorer.parameters">Parameters<a class="headerlink" href="#lengthnormalizedsequencelogprobabilityscorer.parameters" title="Permanent link">&para;</a></h4>

<ul>
<li><strong>length_penalty</strong> : <code>float</code>, optional (default = <code>1.0</code>) <br>
    The length penalty to use. A value of 1.0 means no length penalty is used.
    A value &gt; 1.0 favors longer sequences, and &lt; 1.0 favors shorter sequences.</li>
</ul>
<p><a id="allennlp.nn.beam_search.LengthNormalizedSequenceLogProbabilityScorer.score"></a></p>
<h3 id="score_2">score<a class="headerlink" href="#score_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">LengthNormalizedSequenceLogProbabilityScorer</span><span class="p">(</span><span class="n">FinalSequenceScorer</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">score</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">predictions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">log_probabilities</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.Constraint"></a></p>
<h2 id="constraint">Constraint<a class="headerlink" href="#constraint" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Constraint</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vocab</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Vocabulary</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>An abstract class that can be used to enforce constraints on the output predictions
by manipulating the class log probabilities during beam search.</p>
<p>A <code>Constraint</code> just has three methods that need to be implemented by subclasses:
<code>init_state()</code>, <code>apply()</code> and <code>_update_state()</code>.</p>
<p><code>init_state()</code> takes one argument:</p>
<ul>
<li>the batch size, an int</li>
</ul>
<p>It returns a constraint state, which is a nested list of dictionaries, with any state needed for subsequent
calls to <code>apply()</code> and <code>update_state()</code>. The length of the outer list should be equal to <code>batch_size</code>.
Each inner list should be of length 1.</p>
<p><code>apply()</code> takes two arguments:</p>
<ul>
<li>the constraint state, which is a nested list of dictionaries. The length of the outer list is <code>batch_size</code>
and the length of each inner list is <code>beam_size</code> except on the first time <code>apply()</code> is called when it is 1.</li>
<li><code>class_log_probabilities</code>, a tensor of shape <code>(batch_size, beam_size, num_classes)</code> that contains the
log probabilities for the classes during search. The first time <code>apply()</code> is called, <code>beam_size = 1</code>.</li>
</ul>
<p>The <code>apply()</code> method should return new <code>class_log_probabilities</code> that enforce the constraint
for this step of beam search. For instance, it may prevent a specific class from being selected by setting
the corresponding log probability to a negligible value such as <code>float("-inf")</code> or
<code>min_value_of_dtype(class_log_probabilities.dtype)</code>.</p>
<p><code>_update_state()</code> takes two arguments:</p>
<ul>
<li>the copied parent constraint state, which is a nested list of dictionaries. <code>state[i][j]</code> contains the
copied state for the parent of <code>last_prediction[i, j]</code>. It is unique to that batch and beam, so it can be
directly edited in-place without affecting the others.</li>
<li>last_prediction, a tensor of shape <code>(batch_size, beam_size)</code> containing the predictions from the last
step of beam search.</li>
</ul>
<p>The <code>_update_state()</code> function should return a new constraint state, a nested list of dictionaries of
length <code>batch_size</code> and inner list of length <code>beam_size</code>, one for each of the predictions in <code>last_prediction</code>.</p>
<p><a id="allennlp.nn.beam_search.Constraint.init_state"></a></p>
<h3 id="init_state_2">init_state<a class="headerlink" href="#init_state_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Constraint</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">init_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConstraintStateType</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.Constraint.apply"></a></p>
<h3 id="apply">apply<a class="headerlink" href="#apply" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Constraint</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">state</span><span class="p">:</span> <span class="n">ConstraintStateType</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">class_log_probabilities</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.Constraint.update_state"></a></p>
<h3 id="update_state">update_state<a class="headerlink" href="#update_state" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Constraint</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">update_state</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">state</span><span class="p">:</span> <span class="n">ConstraintStateType</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">last_prediction</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">last_backpointer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConstraintStateType</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.Constraint._update_state"></a></p>
<h3 id="_update_state">_update_state<a class="headerlink" href="#_update_state" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Constraint</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">_update_state</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">state</span><span class="p">:</span> <span class="n">ConstraintStateType</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">last_prediction</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConstraintStateType</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.RepeatedNGramBlockingConstraint"></a></p>
<h2 id="repeatedngramblockingconstraint">RepeatedNGramBlockingConstraint<a class="headerlink" href="#repeatedngramblockingconstraint" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="nd">@Constraint</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;repeated-ngram-blocking&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">RepeatedNGramBlockingConstraint</span><span class="p">(</span><span class="n">Constraint</span><span class="p">):</span>
 <span class="o">|</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ngram_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.RepeatedNGramBlockingConstraint.init_state"></a></p>
<h3 id="init_state_3">init_state<a class="headerlink" href="#init_state_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">RepeatedNGramBlockingConstraint</span><span class="p">(</span><span class="n">Constraint</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">init_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConstraintStateType</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.RepeatedNGramBlockingConstraint.apply"></a></p>
<h3 id="apply_1">apply<a class="headerlink" href="#apply_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">RepeatedNGramBlockingConstraint</span><span class="p">(</span><span class="n">Constraint</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">state</span><span class="p">:</span> <span class="n">ConstraintStateType</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">class_log_probabilities</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.BeamSearch"></a></p>
<h2 id="beamsearch">BeamSearch<a class="headerlink" href="#beamsearch" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">BeamSearch</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">max_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">beam_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">per_node_beam_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">sampler</span><span class="p">:</span> <span class="n">Sampler</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">min_steps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">final_sequence_scorer</span><span class="p">:</span> <span class="n">FinalSequenceScorer</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">constraints</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Lazy</span><span class="p">[</span><span class="n">Constraint</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">vocab</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Vocabulary</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Implements the beam search algorithm for decoding the most likely sequences.</p>
<h4 id="beamsearch.parameters">Parameters<a class="headerlink" href="#beamsearch.parameters" title="Permanent link">&para;</a></h4>

<ul>
<li>
<p><strong>end_index</strong> : <code>int</code> <br>
    The index of the "stop" or "end" token in the target vocabulary.</p>
</li>
<li>
<p><strong>max_steps</strong> : <code>int</code>, optional (default = <code>50</code>) <br>
    The maximum number of decoding steps to take, i.e. the maximum length
    of the predicted sequences.</p>
</li>
<li>
<p><strong>beam_size</strong> : <code>int</code>, optional (default = <code>10</code>) <br>
    The width of the beam used.</p>
</li>
<li>
<p><strong>per_node_beam_size</strong> : <code>int</code>, optional (default = <code>beam_size</code>) <br>
    The maximum number of candidates to consider per node, at each step in the search.
    If not given, this just defaults to <code>beam_size</code>. Setting this parameter
    to a number smaller than <code>beam_size</code> may give better results, as it can introduce
    more diversity into the search. See
    <a href="https://api.semanticscholar.org/CorpusID:2229477"><em>Beam Search Strategies for Neural Machine Translation</em>, Freitag and Al-Onaizan, 2017</a>.</p>
</li>
<li>
<p><strong>sampler</strong> : <code>Sampler</code>, optional (default = <code>None</code>) <br>
    An optional <code>Sampler</code> which is used to pick next candidate nodes and beams.
    If not specified, <code>DeterministicSampler</code> will be used, which just takes the
    <code>per_node_beam_size</code> most likely nodes and the <code>beam_size</code> most likely beams.</p>
<p>Using the <a href="#gumbelsampler"><code>GumbelSampler</code></a>, on the other hand, will give you
<a href="https://api.semanticscholar.org/CorpusID:76662039">Stochastic Beam Search</a>.</p>
</li>
<li>
<p><strong>min_steps</strong> : <code>int</code>, optional (default = <code>None</code>) <br>
    The minimum number of decoding steps to take, i.e. the minimum length of
    the predicted sequences. This does not include the start or end tokens. If <code>None</code>,
    no minimum is enforced.</p>
</li>
<li>
<p><strong>final_sequence_scorer</strong> : <code>FinalSequenceScorer</code>, optional (default = <code>None</code>) <br>
    An optional <code>FinalSequenceScorer</code> which is used to score the final generated sequences.
    The output from this module is what is returned by the <code>search</code> method. If not
    specified, <code>SequenceLogProbabilityScorer</code> will be used, which scores the sequences
    by the sum of the token log probabilities.</p>
</li>
<li>
<p><strong>constraints</strong> : <code>List[Constraint]</code>, optional (default = <code>None</code>) <br>
    An optional list of <code>Constraint</code>s which should be applied during beam search. If not
    provided, no constraints will be enforced.</p>
</li>
<li>
<p><strong>vocab</strong> : <code>Vocabulary</code> <br>
    If <code>constraints</code> is not <code>None</code>, then <code>Vocabulary</code> will be passed to each constraint
    during its initialization. Having access to the vocabulary may be useful for certain
    contraints, e.g., to mask out invalid predictions during structured prediction.</p>
<p>In a typical AllenNLP configuration file, this parameter does not get an entry under the
"model", it gets specified as a top-level parameter, then is passed in to the model
separately.</p>
</li>
</ul>
<p><a id="allennlp.nn.beam_search.BeamSearch.default_implementation"></a></p>
<h3 id="default_implementation_2">default_implementation<a class="headerlink" href="#default_implementation_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">BeamSearch</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="n">default_implementation</span> <span class="o">=</span> <span class="s2">&quot;beam_search&quot;</span>
</code></pre></div>
<p><a id="allennlp.nn.beam_search.BeamSearch.search"></a></p>
<h3 id="search">search<a class="headerlink" href="#search" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">BeamSearch</span><span class="p">(</span><span class="n">Registrable</span><span class="p">):</span>
 <span class="o">|</span> <span class="o">...</span>
 <span class="o">|</span> <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
 <span class="o">|</span> <span class="k">def</span> <span class="nf">search</span><span class="p">(</span>
 <span class="o">|</span>     <span class="bp">self</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">start_predictions</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">start_state</span><span class="p">:</span> <span class="n">StateType</span><span class="p">,</span>
 <span class="o">|</span>     <span class="n">step</span><span class="p">:</span> <span class="n">StepFunctionType</span>
 <span class="o">|</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>
</code></pre></div>
<p>Given a starting state and a step function, apply beam search to find the
most likely target sequences.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your step function returns <code>-inf</code> for some log probabilities
(like if you're using a masked log-softmax) then some of the "best"
sequences returned may also have <code>-inf</code> log probability. Specifically
this happens when the beam size is smaller than the number of actions
with finite log probability (non-zero probability) returned by the step function.
Therefore if you're using a mask you may want to check the results from <code>search</code>
and potentially discard sequences with non-finite log probability.</p>
</div>
<h4 id="search.parameters">Parameters<a class="headerlink" href="#search.parameters" title="Permanent link">&para;</a></h4>

<ul>
<li>
<p><strong>start_predictions</strong> : <code>torch.Tensor</code> <br>
    A tensor containing the initial predictions with shape <code>(batch_size,)</code>.
    Usually the initial predictions are just the index of the "start" token
    in the target vocabulary.</p>
</li>
<li>
<p><strong>start_state</strong> : <code>StateType</code> <br>
    The initial state passed to the <code>step</code> function. Each value of the state dict
    should be a tensor of shape <code>(batch_size, *)</code>, where <code>*</code> means any other
    number of dimensions.</p>
</li>
<li>
<p><strong>step</strong> : <code>StepFunctionType</code> <br>
    A function that is responsible for computing the next most likely tokens,
    given the current state and the predictions from the last time step.
    The function should accept two or three arguments:</p>
<ul>
<li>a tensor of shape <code>(group_size,)</code> representing the index of the predicted
tokens from the last time step,</li>
<li>the current state, a <code>StateType</code>, and</li>
<li>optionally, the timestep, an <code>int</code>.</li>
</ul>
<p>The <code>group_size</code> will be <code>batch_size * beam_size</code>, except in the initial
step, for which it will just be <code>batch_size</code>.</p>
<p>The function is expected to return a tuple, where the first element
is a tensor of shape <code>(group_size, target_vocab_size)</code> containing
the log probabilities of the tokens for the next step, and the second
element is the updated state. The tensor in the state should have shape
<code>(group_size, *)</code>, where <code>*</code> means any other number of dimensions.</p>
</li>
</ul>
<h4 id="search.returns">Returns<a class="headerlink" href="#search.returns" title="Permanent link">&para;</a></h4>

<ul>
<li><code>Tuple[torch.Tensor, torch.Tensor]</code> <br>
    Tuple of <code>(predictions, final_scores)</code>, where <code>predictions</code>
    has shape <code>(batch_size, beam_size, max_steps)</code> and <code>final_scores</code>
    has shape <code>(batch_size, beam_size)</code>.</li>
</ul>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../activations/" class="md-footer__link md-footer__link--prev" aria-label="Previous: activations" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              activations
            </div>
          </div>
        </a>
      
      
        
        <a href="../checkpoint/checkpoint_wrapper/" class="md-footer__link md-footer__link--next" aria-label="Next: checkpoint_wrapper" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              checkpoint_wrapper
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>